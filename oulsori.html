<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>어울소리 40주년 — 스크롤업 시 탭 고정</title>
  <meta name="description" content="한남대학교 풍물놀이패 '어울소리' 창립 40주년 기념 행사 안내 및 참가 신청 페이지" />
  <style>
    :root{
      --brand:#ff2d55;
      --brand-2:#ff7a59;
      --accent:#0ea5e9;
      --hair:#eef0f3;
      --muted:#9aa0a6;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,"Noto Sans KR",sans-serif;
      color:#fff;
      background:#1f1f21;
    }
    a{color:#93c5fd;text-decoration:none}
    img{max-width:100%;display:block}
    .container{width:min(1180px,92%);margin:0 auto}

    /* ===== HERO dark ===== */
    #home{border:none;margin:0;padding:0;background:none}
    .hero-wrap{position:relative; color:#fff; overflow:hidden;
      background:
        radial-gradient(800px 300px at 80% -10%, rgba(255,255,255,.08), transparent 70%),
        radial-gradient(500px 200px at 10% 20%, rgba(255,255,255,.06), transparent 70%),
        radial-gradient(700px 260px at 50% 120%, rgba(255,255,255,.05), transparent 70%),
        #1f1f21;
    }
    .hero-inner{padding:64px 0 0}
    .hero-grid{display:grid;grid-template-columns:1.05fr .95fr;gap:32px;align-items:center}
    @media (max-width:980px){ .hero-grid{grid-template-columns:1fr} }
    .badge{opacity:.9; margin-bottom:10px}
    .anniv-script{color:#ff4d6d; font-weight:700; font-size:clamp(16px,2.2vw,28px)}
    .hero-title{font-weight:900; font-size:clamp(28px,4.8vw,54px); line-height:1.08}

    .cta{display:flex; gap:10px; flex-wrap:wrap; margin-top:18px}
    .btn{padding:12px 18px;border-radius:12px;border:1px solid rgba(255,255,255,.15);cursor:pointer;font-weight:800}
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;border:none}
    .btn.secondary{background:transparent; color:#fff}

    .hero-panel{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.14); border-radius:18px; padding:18px; backdrop-filter: blur(4px)}
    .metric{display:grid;grid-template-columns:1fr auto;gap:6px;align-items:end;margin:4px 0 10px}
    .metric b{font-size:26px;line-height:1}
    .metric span{color:#cbd5e1}
    .countdown{margin-top:6px;padding:10px 12px;background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.14);border-radius:12px;display:inline-block;font-weight:800;font-size:18px;color:#fff}
    .countdown .label{display:block;font-size:12px;font-weight:700;color:#ffd166;margin-bottom:2px;text-align:center}

    .fund-card{margin-top:10px;padding:12px;background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.14);border-radius:14px}
    .bar-bg{width:100%;height:16px;background:rgba(255,255,255,.16);border-radius:999px;overflow:hidden}
    .bar-fill{height:100%;background:linear-gradient(90deg,var(--brand),var(--brand-2));width:0%;transition:width .9s ease}
    .bar-text{margin-top:6px;font-size:13px;text-align:right;color:#e5e7eb}

    /* ===== Hero bottom tabs (in-place) ===== */
    .hero-tabs{ margin-top:48px; background:#0b0b0c; border-top:1px solid rgba(255,255,255,.08); border-bottom:1px solid rgba(255,255,255,.08); }
    .tabs{display:grid;grid-template-columns:repeat(4,1fr)}
    .tab{position:relative; display:flex; align-items:center; justify-content:center; height:68px; color:#7b7f87; font-weight:800; letter-spacing:.02em; border-right:1px solid rgba(255,255,255,.08); text-decoration:none;}
    .tab:last-child{border-right:none}
    .tab.active{background:linear-gradient(90deg,var(--brand),var(--brand-2)); color:#fff;}

    /* ===== Scroll-up docked tabs (fixed; hidden until scroll up) ===== */
    .tabs-dock{
      position:fixed; left:0; right:0; top:0;
      background:#0b0b0c; border-bottom:1px solid rgba(255,255,255,.08);
      transform:translateY(-100%);
      transition:transform .28s ease;
      z-index:999;
    }
    .tabs-dock .tabs{ max-width:1180px; margin:0 auto; width:92%; }
    .tabs-dock .tab{ height:58px; }

    .tabs-dock.show{ transform:translateY(0); }

    /* ===== Cards / sections ===== */
    section.card{background:#fff;color:#111;border:1px solid #e5e7eb;border-radius:20px;box-shadow:0 12px 30px rgba(16,24,40,.08);margin:42px auto;padding:48px 24px}
    h2{font-size:clamp(22px,3.2vw,34px);letter-spacing:-.01em;margin:0 0 6px;color:#111}
    .note{font-size:13px;color:#6b7280;margin:0 0 10px}
    .info-grid{display:grid;grid-template-columns:1fr 1fr;gap:22px}
    @media (max-width:980px){ .info-grid{grid-template-columns:1fr} }
    .info-item{padding:18px;background:#f9fafb;border-radius:14px;border:1px solid #e5e7eb}
    .program table{width:100%;border-collapse:collapse}
    .program th,.program td{border:1px solid #eaeef3;padding:10px;text-align:left}
    .program th{background:#f1f5f9}

    .timeline{padding:18px;background:#f9fafb;border-radius:14px;border:1px solid #e5e7eb}
    .timeline ul{list-style:none;margin:0;padding:0}
    .timeline li{position:relative;margin:0;padding:14px 0 14px 22px;border:0;color:#111}
    .timeline li::before{content:"";position:absolute;left:8px;top:24px;bottom:-24px;width:2px;background:#e5e7eb}
    .timeline li b{display:inline-block;min-width:72px;font-size:18px;color:#111;margin-right:6px}
    .timeline li::after{content:"";position:absolute;left:4px;top:22px;width:10px;height:10px;border-radius:50%;background:linear-gradient(180deg,var(--brand),#ffc043);box-shadow:0 0 0 3px #fff;border:1px solid #e5e7eb}

    .marquee{display:flex;gap:16px;overflow:hidden}
    .marquee .track{display:flex;gap:16px;animation:scrollX 30s linear infinite}
    .marquee img{width:320px;height:210px;object-fit:cover;border-radius:12px;border:1px solid #e5e7eb;box-shadow:0 6px 16px rgba(16,24,40,.08)}
    @keyframes scrollX{from{transform:translateX(0)}to{transform:translateX(-50%)}}

    .contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:22px}
    @media (max-width:980px){ .contact-grid{grid-template-columns:1fr} }
    form .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    input,select,textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e5e7eb;background:#fff;color:#111}
    textarea{min-height:120px}

    footer{padding:24px 0;color:#9aa0a6;text-align:center;border-top:1px solid #2b2b2e;background:#1f1f21}
  </style>
</head>
<body>
  <!-- HERO -->
  <section id="home">
    <div class="hero-wrap">
      <div class="container hero-inner">
        <div class="hero-grid">
          <div>
            <div class="badge">40th Anniversary</div>
            <div class="anniv-script">함께한 40년</div>
            <div class="hero-title">그리고 앞으로<br/>함께할 모든 날들</div>
            <div class="cta" style="margin-top:12px">
              <button class="btn primary" id="openReg">참가신청하기</button>
              <button class="btn secondary" id="openSponsor">후원하기</button>
            </div>
          </div>
          <aside class="hero-panel">
            <div class="metric"><span>목표</span><b>10,000,000원</b></div>
            <div class="fund-card">
              <div class="bar-bg"><div id="fundBar" class="bar-fill"></div></div>
              <div class="bar-text">
                <strong id="fundNow">7,350,000</strong>원 / 
                <span id="fundGoal">10,000,000</span>원 
                (<span id="fundPercent">0%</span>)
              </div>
            </div>
            <div class="countdown" aria-live="polite" style="margin-top:10px">
              <span class="label">D-Day</span>
              <span id="dday">0</span>일  <span id="hours">00</span> : <span id="mins">00</span> : <span id="secs">00</span>
            </div>
          </aside>
        </div>
      </div>

      <!-- bottom tabs (in-place) -->
      <div class="hero-tabs">
        <div class="container tabs">
          <a class="tab active" href="#history">함께한 기록</a>
          <a class="tab" href="#about">행사 안내</a>
          <a class="tab" href="#contact">이벤트/문의</a>
          <a class="tab" href="#home">VIP & 안내</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Fixed dock that appears only on scroll UP -->
  <div id="tabsDock" class="tabs-dock" aria-hidden="true">
    <div class="tabs">
      <a class="tab active" href="#history">함께한 기록</a>
      <a class="tab" href="#about">행사 안내</a>
      <a class="tab" href="#contact">이벤트/문의</a>
      <a class="tab" href="#home">VIP & 안내</a>
    </div>
  </div>

  <!-- ABOUT -->
  <section id="about" class="card">
    <div class="container">
      <h2>행사 안내</h2>
      <p class="note">일정 · 장소 · 주최 및 찾아오시는 길</p>
      <div class="info-grid">
        <div class="info-item">
          <ul style="list-style:none;padding:0;margin:0">
            <li><b>일시</b> : 2026년 5월 30일(토)</li>
            <li><b>장소</b> : 대학아트홀</li>
            <li><b>주최</b> : 풍물놀이패 회원일동</li>
          </ul>
          <div class="program" style="margin-top:10px">
            <h3 style="margin:0 0 6px">식순(안)</h3>
            <table aria-label="행사 식순">
              <thead><tr><th style="width:120px">시간</th><th>내용</th></tr></thead>
              <tbody>
                <tr><td>14:00</td><td>오프닝·집결</td></tr>
                <tr><td>14:10</td><td>내빈 소개 및 축사</td></tr>
                <tr><td>14:30</td><td>공연 1부 (진쇠·삼채)</td></tr>
                <tr><td>15:10</td><td>휴식</td></tr>
                <tr><td>15:25</td><td>공연 2부 (사물놀이 합주)</td></tr>
                <tr><td>16:10</td><td>동문 인터뷰 영상 상영</td></tr>
                <tr><td>16:30</td><td>단체 기념촬영</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="info-item">
          <div id="daumRoughmapContainer1758955056424" class="root_daum_roughmap root_daum_roughmap_landing"></div>
          <div class="note" style="padding-top:8px">* 마커를 클릭하면 카카오 길찾기가 새 창으로 열립니다.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- HISTORY -->
  <section id="history" class="card">
    <div class="container">
      <h2>함께한 기록</h2>
      <p class="note">어울소리 40년의 발자취</p>
      <div class="timeline">
        <ul>
          <li><b>1986</b> 창립</li>
          <li><b>1995</b> 지역 문화축제 첫 대상 수상</li>
          <li><b>2003</b> 해외 교류 공연 시작</li>
          <li><b>2010</b> 정기공연 20회 달성</li>
          <li><b>2016</b> 창립 30주년 기념 굿판</li>
          <li><b>2020</b> 온라인 비대면 공연 시도</li>
          <li><b>2026</b> 창립 40주년 기념 한마당</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="card">
    <div class="container">
      <h2>문의하기</h2>
      <p class="note">담당자 연락처 및 메일 전송</p>
      <div class="contact-grid">
        <div class="info-item" style="background:#fff">
          <h3 style="margin:0 0 6px">담당자</h3>
          <p style="margin:0 0 10px; color:#111">
            이메일: <a id="contactEmail" href="mailto:pungmul40@example.com">pungmul40@example.com</a><br/>
            연락처: <a href="tel:01012345678">010-1234-5678</a><br/>
            인스타그램: <a href="https://instagram.com/pungmul_official" target="_blank" rel="noopener">@pungmul_official</a>
          </p>
          <p class="note">* 실제 연락처로 교체하세요.</p>
        </div>

        <div class="info-item" style="background:#fff">
          <h3 style="margin:0 0 6px; color:#111">메일 보내기</h3>
          <form id="mailForm">
            <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
              <div>
                <label>이름</label>
                <input type="text" name="name" required />
              </div>
              <div>
                <label>이메일</label>
                <input type="email" name="email" />
              </div>
            </div>
            <div style="margin-top:10px">
              <label>내용</label>
              <textarea name="message" required></textarea>
            </div>
            <div style="margin-top:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
              <button class="btn primary" type="submit">메일 전송</button>
              <span class="note">* 현재는 메일 앱으로 전송됩니다. (EmailJS 등 연동 가능)</span>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">© 2026 풍물놀이패 동아리 — 40주년 기념행사</div>
  </footer>

  <!-- 참가신청 모달 -->
  <div id="regModal" class="modal" role="dialog" aria-modal="true" style="display:none;align-items:center;justify-content:center;padding:20px;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:100">
    <div class="dialog" style="background:#fff;color:#111;border:1px solid #e5e7eb;border-radius:12px;max-width:720px;width:96%;padding:20px">
      <header style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:8px">
        <h3 style="margin:0">참가신청</h3>
        <button class="btn" id="closeReg" aria-label="닫기">닫기</button>
      </header>
      <div class="body">
        <form id="regForm">
          <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
            <div>
              <label>이름</label>
              <input type="text" name="name" required />
            </div>
            <div>
              <label>연락처</label>
              <input type="tel" name="phone" placeholder="010-0000-0000" required />
            </div>
          </div>
          <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px">
            <div>
              <label>이메일(선택)</label>
              <input type="email" name="email" />
            </div>
            <div>
              <label>인원수</label>
              <input type="number" name="count" min="1" value="1" required />
            </div>
          </div>
          <div style="margin-top:10px">
            <label>한마디(선택)</label>
            <textarea name="msg" placeholder="동아리에게 전하고 싶은 말"></textarea>
          </div>
          <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;align-items:center">
            <button class="btn primary" type="submit" id="regSubmit">신청 완료</button>
            <button class="btn" type="button" id="testPing" title="시트 연결 테스트">연결 테스트</button>
            <span class="note">* 신청 정보는 구글 시트에만 저장됩니다.</span>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- 후원 계좌 모달 + QR -->
  <div id="sponsorModal" class="modal" role="dialog" aria-modal="true" style="display:none;align-items:center;justify-content:center;padding:20px;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:100">
    <div class="dialog" style="background:#fff;color:#111;border:1px solid #e5e7eb;border-radius:12px;max-width:720px;width:96%;padding:20px">
      <header style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:8px">
        <h3 style="margin:0">후원 계좌 안내</h3>
        <button class="btn" id="closeSponsor" aria-label="닫기">닫기</button>
      </header>
      <div class="body">
        <div style="display:grid;gap:8px">
          <p>후원 1구좌: <b>50,000원</b> · 참가비: <b>50,000원</b></p>
          <div class="account" id="accountNumber" style="font-size:1.2em;font-weight:900;color:#0ea5e9;margin:8px 0">123456-78-901234</div>
          <div class="bank" id="bankInfo" style="font-weight:800;color:#ff2d55">국민은행 · 예금주: 풍물놀이패</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" id="copyAccount">계좌번호 복사</button>
            <button class="btn" id="copyAll">전체 정보 복사</button>
          </div>
          <div class="qr-wrap" style="display:grid;grid-template-columns:1fr auto;gap:14px;align-items:center;margin-top:12px">
            <div class="qr-box" style="background:#fff;padding:12px;border-radius:12px;display:inline-block;border:1px solid #e5e7eb">
              <img id="qrImage" alt="QR 코드" width="220" height="220" />
            </div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn primary" id="downloadQR">QR 이미지 다운로드</button>
              <span class="note">* 은행 앱에서 QR 스캔 → ‘메모/이체’에 활용하세요.</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzAkTilyUWeapEOT6yO3Swe1qmZDyI8yRwpcW-mcZdmN9ODJChbPxSlSxvUIiNyuy4V/exec';
    const $ = (s, root=document) => root.querySelector(s);

    /* D-DAY */
    (function(){
      let eventMs = Date.parse('2026-05-30T00:00:00+09:00');
      if (isNaN(eventMs)) eventMs = Date.parse('2026-05-29T15:00:00Z');
      const dEl = $('#dday'), hEl = $('#hours'), mEl = $('#mins'), sEl = $('#secs');
      if(!dEl || !hEl || !mEl || !sEl) return;
      function tick(){
        const now = Date.now();
        let diff = Math.max(0, eventMs - now);
        const d = Math.floor(diff / 86400000); diff -= d*86400000;
        const h = Math.floor(diff / 3600000); diff -= h*3600000;
        const m = Math.floor(diff / 60000); diff -= m*60000;
        const s = Math.floor(diff / 1000);
        dEl.textContent = d;
        hEl.textContent = String(h).padStart(2,'0');
        mEl.textContent = String(m).padStart(2,'0');
        sEl.textContent = String(s).padStart(2,'0');
      }
      tick(); setInterval(tick, 1000);
    })();

    /* Scroll-up detection for tabsDock */
    (function(){
      const dock = document.getElementById('tabsDock');
      let lastY = window.scrollY;
      let ticking = false;
      function onScroll(){
        const y = window.scrollY;
        const dirUp = y < lastY - 4;       // scroll up threshold
        const dirDown = y > lastY + 4;     // scroll down threshold
        const pastHero = y > 140;          // start showing once past hero top area
        if (dirUp && pastHero){
          dock.classList.add('show');
        } else if (dirDown || !pastHero){
          dock.classList.remove('show');
        }
        lastY = y;
        ticking = false;
      }
      window.addEventListener('scroll', ()=>{
        if(!ticking){
          window.requestAnimationFrame(onScroll);
          ticking = true;
        }
      }, {passive:true});
    })();

    /* Modals */
    const regModal = $('#regModal');
    const sponsorModal = $('#sponsorModal');
    document.getElementById('openReg').addEventListener('click', ()=> regModal.style.display='flex');
    document.getElementById('closeReg').addEventListener('click', ()=> regModal.style.display='none');
    regModal.addEventListener('click', (e)=>{ if(e.target.id==='regModal') regModal.style.display='none'; });

    document.getElementById('openSponsor').addEventListener('click', ()=> sponsorModal.style.display='flex');
    document.getElementById('closeSponsor').addEventListener('click', ()=> sponsorModal.style.display='none');
    sponsorModal.addEventListener('click', (e)=>{ if(e.target.id==='sponsorModal') sponsorModal.style.display='none'; });

    /* QR */
    const acctEl = document.getElementById('accountNumber');
    const bankEl = document.getElementById('bankInfo');
    const qrImg = document.getElementById('qrImage');
    function refreshQR(){
      const payload = acctEl.textContent.trim() + ' | ' + bankEl.textContent.trim();
      const url = 'https://chart.googleapis.com/chart?chs=220x220&cht=qr&chl=' + encodeURIComponent(payload);
      qrImg.src = url; qrImg.alt = 'QR: ' + payload;
    }
    refreshQR();
    document.getElementById('copyAccount').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(acctEl.textContent.trim()); alert('계좌번호가 복사되었습니다.'); }catch(_){ alert('복사에 실패했습니다.'); }
    });
    document.getElementById('copyAll').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(acctEl.textContent.trim() + ' / ' + bankEl.textContent.trim()); alert('전체 정보가 복사되었습니다.'); }catch(_){ alert('복사에 실패했습니다.'); }
    });
    document.getElementById('downloadQR').addEventListener('click', ()=>{
      const a = document.createElement('a'); a.href = qrImg.src; a.download = 'pungmul_sponsor_qr.png'; a.click();
    });

    /* GAS submit */
    document.getElementById('regForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const submitBtn = document.getElementById('regSubmit');
      const fd = new FormData(e.target);
      const body = new URLSearchParams({
        name:  String(fd.get('name') || '').trim(),
        phone: String(fd.get('phone')|| '').trim(),
        email: String(fd.get('email')|| '').trim(),
        count: String(Math.max(1, Number(fd.get('count'))||1)),
        msg:   String(fd.get('msg')  || '').trim(),
        ts:    new Date().toISOString()
      });
      if(!SHEET_ENDPOINT){ alert('관리자 설정 필요: SHEET_ENDPOINT 비어있음'); return; }
      try {
        submitBtn.disabled = true; submitBtn.textContent = '전송 중...';
        const res = await fetch(SHEET_ENDPOINT, { method: 'POST', body });
        try { console.log('[GAS] response:', await res.clone().text()); } catch(_) {}
        alert('신청이 접수되었습니다. 감사합니다!');
        e.target.reset(); regModal.style.display='none';
      } catch (err) {
        console.error(err);
        alert('구글 시트 저장 실패(네트워크/권한/CORS 설정 확인)');
      } finally {
        submitBtn.disabled = false; submitBtn.textContent = '신청 완료';
      }
    });

    /* mailto */
    document.getElementById('mailForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const to = document.getElementById('contactEmail').textContent.trim();
      const subject = encodeURIComponent('[문의] ' + (fd.get('name')||'') + '님');
      const body = encodeURIComponent(
        '이름: ' + (fd.get('name')||'') + '\n' +
        '이메일: ' + (fd.get('email')||'') + '\n\n' +
        '내용:\n' + (fd.get('message')||'')
      );
      location.href = 'mailto:' + to + '?subject=' + subject + '&body=' + body;
    });

    /* funding bar (view-only) */
    (function(){
      const nowEl = document.getElementById('fundNow');
      const goalEl= document.getElementById('fundGoal');
      const bar   = document.getElementById('fundBar');
      const pctEl = document.getElementById('fundPercent');
      if(!nowEl || !goalEl || !bar || !pctEl) return;
      const now  = Number(nowEl.textContent.replace(/[^\d]/g,''));
      const goal = Number(goalEl.textContent.replace(/[^\d]/g,''));
      const ratio = Math.min(1, now / goal);
      const percent = (ratio * 100).toFixed(1);
      pctEl.textContent = percent + '%';
      bar.style.width = percent + '%';
    })();
  </script>

  <!-- Kakao RoughMap -->
  <script charset="UTF-8" class="daum_roughmap_loader_script" src="https://ssl.daumcdn.net/dmaps/map_js_init/roughmapLoader.js"></script>
  <script charset="UTF-8">
  	new daum.roughmap.Lander({
  		"timestamp" : "1758955056424",
  		"key" : "9ttv8jh4qs4",
  		"mapWidth" : "100%",
  		"mapHeight" : "360"
  	}).render();
  </script>
</body>
</html>
